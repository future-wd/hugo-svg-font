{{- /*
HUGO SVG FONT
usage: {{ partial "scripts/svg-font" (dict "svg" "icons/bootstrap/envelope" "em" 1 "block" true/false )}} 
*/ -}}
{{ $src := "" }}
{{ $size := 1 }}
{{ $block := false }}
{{ if reflect.IsMap . }}
{{ $src = .src }}
{{- /* declare size for svg style */ -}}
{{- $size := .em | default 1 -}}
{{- /* display: block style conditional - keeps a square svg square but not useful for use inline with text */ -}}
{{- if .block -}}
{{- $block = "display: block;" -}}
{{- end -}}
{{ else }}
{{ $src = . }}
{{ end }}
{{- $glob := "%s.svg" -}}
{{- if strings.HasSuffix $src ".src" }}
  {{- $glob = "%s.*" -}}
{{- end -}}
{{- $svgFile := resources.Get (printf $glob $src ) -}}
{{- /* strip file path and extension */ -}}
{{- /*- $svgFileName := replaceRE ".*\\/(.*)\\.[^.]+$" "$1" $svgFile.Name */ -}}
{{- /* get svg content */ -}}
{{- $svgContent := $svgFile.Content -}}
{{- $height := index (findRE `height=\"([0-9]*)\"` $svgContent 1) 0 -}}
{{- $width := index (findRE `width=\"([0-9]*)\"` $svgContent 1) 0 -}}
{{- $viewBox := index (findRE `viewBox=\"([0-9\s]*)\"` $svgContent 1) 0 -}}
{{- $content := index (findRE `<path(.*)/>` $svgContent) 0 -}}
{{- $class := printf "svg-font em-%v" $size }}
{{- if $block -}}
{{- $class = print $class " d-block" -}}
{{- end -}}
{{- /* add size in em to style parameter */ -}}
{{- $style := printf "height: %vem; width: %vem; font-size: inherit; color: inherit; fill: currentColor; vertical-align: middle; %s" $size $size $block }}

{{ $svgModified := printf `<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" %s %s %s class="%s">%v</svg>` $height $width $viewBox $class $content -}}
{{- $svgModified | safeHTML -}}
